@echo off
echo =======================================================
echo          SIMS Project Setup Script for Windows
echo =======================================================

echo.
echo [+] Creating project directory structure...
mkdir api
mkdir frontend
mkdir nginx
mkdir data
mkdir data\sql
mkdir data\mongo
mkdir data\grafana
mkdir data\portainer

echo.
echo [+] Creating placeholder Dockerfiles and advanced nginx.conf...

(echo # Placeholder for API Dockerfile) > api\Dockerfile
(echo # Placeholder for Frontend Dockerfile) > frontend\Dockerfile
(echo # Placeholder for NGINX Dockerfile) > nginx\Dockerfile

(
    echo events {}
    echo http {
    echo     server {
    echo         listen 80;
    echo         location / { proxy_pass http://frontend; }
    echo         location /api/ { proxy_pass http://api; }
    echo         location /grafana/ { proxy_pass http://grafana:3000/; }
    echo         location /portainer/ { proxy_pass http://portainer:9000/; }
    echo         location /portainer/api/websocket/ {
    echo             proxy_set_header Upgrade $http_upgrade;
    echo             proxy_set_header Connection "upgrade";
    echo             proxy_http_version 1.1;
    echo             proxy_pass http://portainer:9000/api/websocket/;
    echo         }
    echo     }
    echo }
) > nginx\nginx.conf

echo.
echo [+] Creating default .env file with placeholder credentials...
(
    echo # Default Environment Variables - CHANGE FOR PRODUCTION
    echo SQL_PASSWORD=YourStrong!SQLPa55word
    echo MONGO_USER=simsadmin
    echo MONGO_PASSWORD=YourStrong!MongoPa55word
) > .env

echo.
echo [!] IMPORTANT: The .env file has been created with default passwords.

echo.
echo [+] Starting Docker containers in detached mode...
docker-compose up --build -d

echo.
echo =======================================================
echo      Setup Complete! The application is starting.
echo      Access everything through http://localhost
echo      (See README.md for specific service URLs)
echo =======================================================

echo.
pause